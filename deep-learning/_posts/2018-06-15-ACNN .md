---
layout: review
title:  "Anatomically Constrained Neural Networks (ACNN)"
tags:   deep-learning segmentation autoencoder
author: Sarah Leclerc
pdf:    https://arxiv.org/abs/1705.08302
cite:
  authors: "O. Oktay, E. Ferrante, K. Kamnitsas, M. Heinrich, W. Bai, J. Caballero, S. A. Cook, A. de Marvao, T. Dawes, D. P. Oâ€˜Regan, B. Kainz, B. Glocker, D. Rueckert"
  title:   "Anatomically Constrained Neural Networks (ACNN): Application to Cardiac Image Enhancement and Segmentation"
  venue:   "IEEE Transactions on Medical Imaging 2018"
---


The authors propose to use autoencoders to extract shape prior knowledge as a low dimension representations (code) of segmentation maps. Their module can also be used for image enhancement (super-resolution), and as a feature extractor for decision trees to predict pathologies.

Here is the segmentation pipeline :

![](/deep-learning/images/ACNN/ACNN-pipeline.png)

The segmentation CNN is trained so that the generated segmentation code would be close to the original segmentation latent representation. This is done by adding an Euclidean loss between the two codes to the original Cross-Entropy and weight decay terms :

![](/deep-learning/images/ACNN/ACNN-loss.png)


---

They apply this model on :
1. The 3D MRI UK Digital Heart Project dataset 
2. The 3D echographic CETUS dataset
In both cases, they obtained SOTA results on geometric metrics :  

![](/deep-learning/images/ACNN/ACNN-results1.png)
![](/deep-learning/images/ACNN/ACNN-results2.png)
In addition to encouraging plausible global shape, their module acts as a good false positive detector and no post-processing of the segmentation maps was needed (which is a strong selling point).
---

They also propose a way to use their module to perform image super-resolution by training a predictor to produce segmentation latent code from image intensity (T-L network), wich they applied to the dataset 1., showing consistency in interpoling anatomical borders :
![](/deep-learning/images/ACNN/ACNN-TL.png)
![](/deep-learning/images/ACNN/ACNN-superres.png)
---

Their encoding network captures anatomical variations much like shape models based on PCA do, making it potentially useful to perform pathology detection :

![](/deep-learning/images/ACNN/ACNN-shape_var.png)

On this small part, they compare decision trees classification accuracy on the ACDC MRI pathology prediction dataset. Trees features are based either on their segemntation codes or on PCA. They indicate a $91.6%$ accuracy when using both End Diastole and End Systole phases.