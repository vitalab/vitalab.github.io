---
layout: review
title: "DOMINO: Domain-aware Model Calibration in Medical Image Segmentation"
tags: deep-learning medical segmentation 
author: "Thierry Judge"
cite:
    authors: "Skylar E. Stolte, Kyle Volle, Aprinda Indahlastari, Alejandro Albizu, Adam J. Woods, Kevin Brink, Matthew Hale, Ruogu Fang"
    title:   "DOMINO: Domain-aware Model Calibration in Medical Image Segmentation"
    venue:   "MICCAI 2022"
pdf: "https://arxiv.org/pdf/2209.06077.pdf"
---

# Introduction

This paper tackles the task of model calibration (i.e. confidence should correspond to the probability of being 
correctly classified). 

The authors identify problems with current uncalibrated loss functions: 
* They can arbitrarily increase confidence 
* They confuse classes equally 

# Method 

The authors propose a new loss function that does not penalize all errors te same way. 

$$
loss = \mathcal{L}(y, \hat{y}) + \beta(y^T W \hat{y})    
$$

where $$\mathcal{L}$$ is a cross-entropy loss, $$W$$ is a "confusion matrix" that indicates the penalties between classes and 
$$\beta$$ is a constant.

The authors propose 2 ways of finding $W$: 

1. **Confusion Matrix (UNETR-CM)**. 

The authors train an uncalibrated model and compute the confusion matrix $$C$$. 
They normalize and set the diagonal to 0 and scale by a constant $$S$$. 

$$
W_{ij} = S \cdot \frac{I_i - C_{ij}}{I_i}
$$


2. **Hierarchical Class (UNETRHC)**

This an expert learned method. They group labels together and manually lower penalties between these classes. 

![](/article/images/domino/tab1.jpeg)


The resulting $$W$$ matrices 

![](/article/images/domino/figw.jpeg)


# Results 

The authors conduct experiments on data from Phase III clinical trial on cognitive training and
non-invasive brain stimulation for cognitive improvements. The brain tissue was segmented into 11 classes: muscle, fat, skin, cortical bone, cancellous bone, major artery (blood), air, cerebrospinal fluid (CSF),
eyes, grey matter (GM), and white matter (WM). 

Their methods obtain better performance on top-N accuracy and calibration than the baseline. 

![](/article/images/domino/tab2.jpeg)

![](/article/images/domino/figcal.jpeg)

![](/article/images/domino/fig4.jpeg)
